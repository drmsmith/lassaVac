# CHIK-X

CHIK-X transmission model for 100 days mission evaluation of vaccine impact.

The code in this repository is based on David Smith's code for Lassa-X transmission. David's code is associated with the following preprint: 

> "Projecting health and economic impacts of Lassa vaccination campaigns in West Africa "
This code was developed by OxLiv Consortium members David R M Smith, Joanne Turner, Patrick Fahr, Paul Bessell, Emily Nixon, Koen Pouwels and Deirdre Hollingsworth.



# Running the model: repo structure

The following gives a high-level overview of the repo structure and components used/needed for the model to run. 

```
│   .gitignore
│   CHIK-X.Rproj                            // set working dir and run project
│   CHIK-X_run.R                            // should run the entire model 
│   CHIK-X_diagnostics_postprocessing.R     // help visualising runs for diagnostics and postprocessing 
│   README.md
│
├───data                    // data used by model components to run sims
├───figs                    // create for visualisations
│   └───diagnostic_plots    // and diagnostics
├───model                   // model components 
│       CHIK-X_spread.R                 // (1) Simulate the spillover and spread of CHIK-X
│       CHIK-X_init_conditions.R        // (2) Calculate initial conditions for simulations (ODE relic)
│       CHIK-X_sim.R                    // (3) Run simulation 
│       utils.R                         // sourced by CHIK-X_sim.R
│       misc.R                          // help with debugging / benchmarking etc, not used by model 
│       _spread_diagnostics.R           // help with debugging the spread model for fine-tuning 
├───res                     // results saved here 
└───preprocessing           // see below 
```

Below are more details on the data files which are required by the model to run the simulations. These are generated by the scripts in the pre-processing directory (see next section).

```

│   
└───data
       df_countries_burden_estimates_cepi.csv          // Salje et al. burden estimates ("raw" data)
       df_burden_with_pop_size_2015_spillover.csv      // Salje et al., with 2015 pop size and p(spillover) 
       mat_mobility_2015.csv                           // pairwise mobility data (n trips, 2015)
       mat_mob_prob_fudge.csv                          // p(moving) with a fudge factor to speed up simulations
       shape_params_PAHO_cases_adj.csv                 // manually adjusted PAHO data shape fit parameters 
       inputs_ls_spread.RData                          // produced by running spread model
       inputs_ls_initial_conditions.RData              // initial conditions for simulations 
        
```


# CHIK-X spread drivers 

The following files contain the information used to calculate the risk of spread based on mobility data and estimated incidence. 


```
└───preprocessing
   ├───curve_fitting                   // fitting curves to PAHO data 
   │   │   estimate_shapes.R            // fit hyperbolic function to PAHO data
   │   │   estmt_shape_amplitude.R      // as above but also estimate amplitude 
   │   │                                //
   │   │   sample_curves.R
   │   │   shape_problems.R
   │   │   
   │   ├───PAHO_shape_fit_figs_original data           // fit vs data for PAHO
   │   ├───curve_preds_man_adj                         // fit vs data for manually adjusted 
   │   │       
   │   └────paho_case_data             // outbreak reports downloaded from 
   │          paho_2014-2017.csv      // https://www3.paho.org/data/index.php/en/mnu-topics/chikv-en/550-chikv-weekly-en.html
   │          PAHO_long_per_capita_outbreaks.csv  // raw data in long format (from paho_2014-2017.csv)
   │          PAHO_long_outbreaks_zeros.csv       // manually adjusted data with added zeros for fitting
   │          paho_outbreaks.csv                  // individual marked outbreaks - raw data 
   │          paho_outbreaks.RData
   │          paho_outbreaks_manual_adj.csv       // individual marked outbreaks - raw data 
   │          paho_outbreaks_manual_adj.RData 
   │               
   ├───mobility_and_p_spillover
   │       2015_p_spillover.pdf                 // visualise 2015 mobility data
   │       heatmap_2015.pdf
   │       KCMD_EUI_GMP_Estimated_trips.csv     // GMP mobility data, 2015
   │       mobility_processing.R                // processing GMP data to get mat_mobility.csv 
   │       p_spillover.R
   │       
   └───scr_UN_worldpop
       │   utils.R                      // funcs to query and download worldpop data
       │   worldpop.R                   // script downloads data into dir below 
       │   worldpop_failed_packages.R   // some other packages which did not work
       │   
       └───worldpop_2016_1kmUNadj_data  // tiff file for every country 
                   
```





